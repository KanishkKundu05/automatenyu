// NYU Logo ASCII Art
// Flame lines animate by shifting left/right.
// Rectangle/handle lines are widened 20%.

const BASE_ART = `=##################################################################################################+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+..*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=...-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#:.....*%%%%%%+#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=#%%%%%%%%*.......-%%%%%+.:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#.-%%%%%%%-.........%%%%=...+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:..=%%%%+..........:#%#:....:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-....#%%-.........:*%%-.......*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-....-%#.........:*%#-.........*%%%%-#%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-....-%#.........=%%-...........#%%*..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-.....%%:........#%+...........-#%#:..:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=.....+%=........#%-........:+%%%+.....=%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%#......#%........#%=.......+%%#-........#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%*......#%.......=%*.....:#%#-.... .....=%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%*......*%=......*%-....+%%:.... ......:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:......%%-.....#%:...*%*............:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.....:%%=....*%-..*%+............-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=......*%%:..=%+.=%*...........:#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+.....:#%#:.%%-%%..........+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+-::=%%#%%%*...:-+#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*.............:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*..............%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*:::::::-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#.......-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:......+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:......#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=.....:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+.....-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#.....+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:....*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-....#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=...:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+...=%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*...*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#...%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=.-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#-*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+
=##################################################################################################=`.split("\n");

// --- Configuration ---
const FLAME_START = 9;
const FLAME_END = 32;
const WIDEN_LINES = [30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48];
const WIDEN_FACTOR = 0.2;
const OFFSETS = [0, 1, 3, 2, 0, -1, -3, -2];

// --- Utilities ---

function getDesignBounds(
  inner: string
): { start: number; end: number } | null {
  let start = -1;
  let end = -1;
  for (let i = 0; i < inner.length; i++) {
    if (inner[i] !== "%") {
      if (start === -1) start = i;
      end = i;
    }
  }
  return start === -1 ? null : { start, end };
}

/** Shift the non-% design block left (negative) or right (positive). */
function shiftDesign(line: string, offset: number): string {
  if (offset === 0) return line;
  const first = line[0];
  const last = line[line.length - 1];
  const inner = line.slice(1, -1);
  const bounds = getDesignBounds(inner);
  if (!bounds) return line;

  const newLeft = bounds.start + offset;
  const newRight = inner.length - 1 - bounds.end - offset;
  if (newLeft < 0 || newRight < 0) return line;

  const design = inner.slice(bounds.start, bounds.end + 1);
  return (
    first + "%".repeat(newLeft) + design + "%".repeat(newRight) + last
  );
}

function getMostCommon(s: string): string {
  const counts = new Map<string, number>();
  for (const ch of s) counts.set(ch, (counts.get(ch) || 0) + 1);
  let best = s[0];
  let max = 0;
  for (const [ch, n] of counts) {
    if (n > max) {
      max = n;
      best = ch;
    }
  }
  return best;
}

/** Widen the design region by `factor`, padding with the dominant fill char. */
function widenDesign(line: string, factor: number): string {
  const first = line[0];
  const last = line[line.length - 1];
  const inner = line.slice(1, -1);
  const bounds = getDesignBounds(inner);
  if (!bounds) return line;

  const design = inner.slice(bounds.start, bounds.end + 1);
  if (design.length < 2) return line;

  const extra = Math.max(1, Math.round(design.length * factor));
  const extraLeft = Math.floor(extra / 2);
  const extraRight = extra - extraLeft;

  const leftBound = design[0];
  const rightBound = design[design.length - 1];
  const interior = design.slice(1, -1);
  const fillChar = interior.length > 0 ? getMostCommon(interior) : ".";

  const newDesign =
    leftBound +
    fillChar.repeat(extraLeft) +
    interior +
    fillChar.repeat(extraRight) +
    rightBound;

  const newLeftPad = bounds.start - extraLeft;
  const newRightPad = inner.length - 1 - bounds.end - extraRight;
  if (newLeftPad < 0 || newRightPad < 0) return line;

  return (
    first +
    "%".repeat(newLeftPad) +
    newDesign +
    "%".repeat(newRightPad) +
    last
  );
}

// --- Build frames ---

// 1. Widen rectangle / handle lines on the base art
const art = BASE_ART.map((line, i) =>
  WIDEN_LINES.includes(i) ? widenDesign(line, WIDEN_FACTOR) : line
);

// 2. Generate animation frames (flame shifts, rest stays static)
export const frames: string[][] = OFFSETS.map((baseOffset) =>
  art.map((line, i) => {
    if (i < FLAME_START || i > FLAME_END) return line;
    // Taper: top of flame gets full shift, base barely moves
    const progress = (i - FLAME_START) / (FLAME_END - FLAME_START);
    const lineOffset = Math.round(baseOffset * (1 - progress * 0.7));
    return shiftDesign(line, lineOffset);
  })
);
